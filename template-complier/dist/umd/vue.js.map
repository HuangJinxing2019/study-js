{"version":3,"file":"vue.js","sources":["../../../data_observe/modules/vue/defineReactive.js","../../../data_observe/modules/vue/observeArray.js","../../../data_observe/modules/vue/Observer.js","../../../data_observe/modules/vue/observe.js","../../../data_observe/modules/vue/array.js","../../src/utils.js","../../../MVVM_SIMPLE/MVVM/shared/index.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/compiler/astParser.js","../../src/compiler/index.js","../../src/init.js","../../src/index.js"],"sourcesContent":["import {observe} from \"./observe\";\r\n\r\nexport function defineReactive(target, key, value){\r\n  observe(value)\r\n  Object.defineProperty(target, key, {\r\n    get(){\r\n      console.log('获取属性key:' + key + ' 值为：'+ value)\r\n      return value\r\n    },\r\n    set(val){\r\n      console.log('设置属性key:' + key + ' 值为：'+ val)\r\n      observe(val)\r\n      value = val\r\n    }\r\n\r\n  })\r\n}","import {observe} from \"./observe\";\r\n\r\nexport function observeArray(arr){\r\n  for(let item of arr){\r\n    observe(item);\r\n  }\r\n}","import {defineReactive} from \"./defineReactive\";\r\nimport arrMethods from \"./array\";\r\nimport {observeArray} from \"./observeArray\";\r\n\r\nexport function Observer(data){\r\n   if(Array.isArray(data)){\r\n     observeArray(data)\r\n    data.__proto__ = arrMethods\r\n   } else {\r\n     this.walk(data)\r\n   }\r\n}\r\n\r\nObserver.prototype.walk = function (data){\r\n  for (let key in data){\r\n    if(Object.hasOwn(data, key)){\r\n      defineReactive(data, key, data[key])\r\n    }\r\n  }\r\n}","import {Observer} from \"./Observer\";\r\n\r\nexport function observe(data){\r\n  if(typeof data !== 'object' || data === null) return\r\n  new Observer(data)\r\n}","import {observe} from \"./observe\";\r\nimport {observeArray} from \"./observeArray\";\r\n\r\nconst arrPrototype = Array.prototype,\r\n      arrMethods = Object.create(arrPrototype);\r\nlet arrProto = [\r\n  'push',\r\n  'pop',\r\n  'shift',\r\n  'unshift',\r\n  'sort',\r\n  'splice',\r\n  'reverse',\r\n]\r\narrProto.map(m => {\r\n  arrMethods[m] = function (){\r\n    console.log('拦截了数组的方法')\r\n    const args = Array.prototype.slice.call(arguments),\r\n          rt = arrPrototype[m].apply(this, args);\r\n    let newArr;\r\n    switch (m){\r\n      case 'push':\r\n      case 'shift':\r\n        newArr = args\r\n        break;\r\n      case 'splice':\r\n          newArr = args.slice(2)\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    if(newArr) observeArray(newArr)\r\n    return rt\r\n  }\r\n})\r\n\r\nexport default arrMethods","import array from \"../../data_observe/modules/vue/array\";\r\n\r\nexport function proxy(target, sourceKey, key){\r\n  Object.defineProperty(target, key, {\r\n    get(){\r\n      return target[sourceKey][key]\r\n    },\r\n    set(val){\r\n      if(target[sourceKey][key] === val) return;\r\n      target[sourceKey][key] = val\r\n    }\r\n  })\r\n}\r\n\r\nexport function isObject(value){\r\n  return typeof value === 'object' && value !== null\r\n}\r\nexport function setConstantProperty(data, key, value){\r\n  Object.defineProperty(data, key, {\r\n    enumerable: false,\r\n    configurable: false,\r\n    value\r\n  })\r\n}\r\n\r\nexport function isArray(value){\r\n  return Array.isArray(value)\r\n}","const reg_check_str = /^[\\'|\\\"].*?[\\\"|\\']/;\r\nconst reg_str = /[\\'|\\\"]/g\r\nexport const isObject = function (data){\r\n  return typeof data === 'object' && data !== null\r\n}\r\nexport const randomNum = () => {\r\n  return parseInt(new Date().getTime() + Math.random() * 1000)\r\n}\r\nexport const hasOwnProperty = (target, key) => {\r\n  return Object.hasOwn(target, key)\r\n}\r\nexport const isEqual = (value, oldValue) => {\r\n  return value === oldValue;\r\n}\r\nexport const checkType = (str) => {\r\n  let isStr = reg_check_str.test(str);\r\n  if(isStr){\r\n    return str.replace(reg_str, '');\r\n  }\r\n  switch (str){\r\n    case 'true':\r\n      return true\r\n    case 'false':\r\n      return false\r\n    default:\r\n      break;\r\n  }\r\n  return Number(str)\r\n}","const arrPrototype = Array.prototype,\r\n      arrMethods = Object.create(arrPrototype);\r\nconst arrProtoMethods = [\r\n  'push',\r\n  'pop',\r\n  'shift',\r\n  'unshift',\r\n  'sort',\r\n  'splice',\r\n  'reverse'\r\n]\r\narrProtoMethods.map(m => {\r\n  arrMethods[m] = function (...args){\r\n\r\n    const result = arrPrototype[m].apply(this, args),\r\n          ob = this.__ob__;\r\n    let newArr;\r\n    switch (m){\r\n      case 'push':\r\n      case 'unshift':\r\n        console.log(`数组方法拦截push/unshift：${args}`)\r\n        newArr = args;\r\n        break;\r\n      case 'splice':\r\n        console.log(`数组方法拦截slice：${args}`)\r\n        newArr = args.slice(2)\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    if(newArr) ob.observeArr(newArr);\r\n    return result;\r\n  }\r\n})\r\nexport {\r\n  arrMethods\r\n}","import {isObject} from \"../../../MVVM_SIMPLE/MVVM/shared\";\r\nimport {setConstantProperty, isArray} from \"../utils\";\r\nimport {arrMethods} from \"./array\";\r\n\r\nclass Observer{\r\n  constructor(data) {\r\n    setConstantProperty(data, '__ob__', this)\r\n    if(isArray(data)){\r\n      data.__proto__ = arrMethods\r\n      this.observeArr(data)\r\n    }else {\r\n      this.walk(data)\r\n    }\r\n  }\r\n  walk(data){\r\n    const keys = Object.keys(data)\r\n    for(let key of keys){\r\n      defineReactive(data, key, data[key])\r\n    }\r\n  }\r\n  observeArr(arr){\r\n    for (let item of arr){\r\n      observe(item)\r\n    }\r\n  }\r\n}\r\n\r\nfunction defineReactive(target, key, value){\r\n  observe(value)\r\n  Object.defineProperty(target, key, {\r\n    get(){\r\n      console.log(`数据获取${key} value: ${value}`)\r\n      return value\r\n    },\r\n    set(newValue){\r\n      if(newValue === value) return\r\n      console.log(`数据设置${key} value: ${newValue}`)\r\n      observe(newValue)\r\n      value = newValue\r\n    }\r\n  })\r\n}\r\n\r\nexport function observe(data){\r\n  if (!isObject(data) || data.__ob__) return data\r\n  new Observer(data)\r\n}","import {proxy} from \"./utils\";\r\nimport {observe} from \"./observer\";\r\n\r\nexport function initState(vm){\r\n  const options = vm.$options;\r\n  if(options.data){\r\n    initData(vm)\r\n  }\r\n}\r\nfunction initData(vm){\r\n  let data = vm.$options.data;\r\n  vm._data = data = typeof data === 'function' ? data.call(vm) : data\r\n\r\n  for (let key in data){\r\n    if(Object.hasOwn(data, key)){\r\n      proxy(vm, '_data', key)\r\n    }\r\n  }\r\n  observe(data)\r\n}","// id=\"app\" id='app' id=app\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\r\n//标签名  <my-header></my-header>\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;\r\n// <my:header></my:header>\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\r\n// <div\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`);\r\n// > />\r\nconst startTagClose = /^\\s*(\\/?)>/;\r\n// </div>\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`);\r\n\r\nexport function parseHtmlToAst(html){\r\n  console.log(html)\r\n  return html\r\n}","import {parseHtmlToAst} from \"./astParser\";\r\n\r\nexport function compilerToRenderFunction(html){\r\n  const ast = parseHtmlToAst(html);\r\n  return ast;\r\n}","import {initState} from \"./state\";\r\nimport { compilerToRenderFunction } from \"./compiler\";\r\n\r\nexport function initMixin(Vue){\r\n  Vue.prototype._init = function (options){\r\n    const vm = this\r\n    vm.$options = options\r\n    if(vm.$options.el){\r\n      vm.$mount(vm.$options.el)\r\n    }\r\n    initState(vm)\r\n  }\r\n  Vue.prototype.$mount = function (el){\r\n    const vm = this,\r\n          options = vm.$options;\r\n    vm.$el = document.querySelector(el);\r\n    if(!options.render){\r\n      let template = options.template;\r\n      if(!template && el){\r\n        template = vm.$el.outerHTML;\r\n      }\r\n      const render = compilerToRenderFunction(template);\r\n      options.render = render;\r\n    }\r\n  }\r\n}","import {initMixin} from \"./init\";\r\n\r\nfunction Vue(options){\r\n  this._init(options)\r\n}\r\ninitMixin(Vue)\r\nexport default Vue"],"names":["defineReactive","target","key","value","observe","Object","defineProperty","get","console","log","set","val","observeArray","arr","item","Observer","data","Array","isArray","__proto__","arrMethods","walk","prototype","hasOwn","arrPrototype","create","arrProto","map","m","args","slice","call","arguments","rt","apply","newArr","proxy","sourceKey","setConstantProperty","enumerable","configurable","isObject","arrProtoMethods","result","ob","__ob__","observeArr","constructor","keys","newValue","initState","vm","options","$options","initData","_data","parseHtmlToAst","html","compilerToRenderFunction","ast","initMixin","Vue","_init","el","$mount","$el","document","querySelector","render","template","outerHTML"],"mappings":"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"}